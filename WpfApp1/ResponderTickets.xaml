<Window x:Class="UI.Views.ResponderTickets"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"


        Title="Responder Tickets" Height="500" Width="800" WindowStartupLocation="CenterScreen">

    <Grid Margin="10">

        <!-- Menu Inicial -->
        <StackPanel x:Name="MainMenu" HorizontalAlignment="Center" VerticalAlignment="Center" Visibility="Visible" >
            <Button Content="Responder Tickets" Width="200" Height="40" Margin="0,10" Click="BtnResponderTickets_Click"/>
            <Button Content="Ver Mapas" Width="200" Height="40" Margin="0,10" Click="BtnVerMapas_Click"/>
            <Button Content="Logout" Width="200" Height="40" Margin="0,10" Click="BtnLogout_Click"/>
        </StackPanel>

        <!-- Responder Tickets -->
        <StackPanel x:Name="ResponderSection" Visibility="Collapsed">
            <StackPanel Orientation="Horizontal" Margin="0 0 0 10">
                <!-- Filtros -->
                <GroupBox Header="Filtros" Margin="0,0,0,10" Padding="10">
                    <StackPanel Orientation="Vertical">
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                            <TextBlock Text="Tipo:" Width="80" VerticalAlignment="Center"/>
                            <ComboBox Width="120" SelectedItem="{Binding FiltroTipo}">
                                <ComboBox.ItemsSource>
                                    <x:Array Type="{x:Type sys:String}">
                                        <sys:String>Todos</sys:String>
                                        <sys:String>Hardware</sys:String>
                                        <sys:String>Software</sys:String>
                                    </x:Array>
                                </ComboBox.ItemsSource>
                            </ComboBox>

                            <TextBlock Text="Prioridade:" Width="80" Margin="20,0,0,0" VerticalAlignment="Center"/>
                            <ComboBox Width="120" SelectedItem="{Binding FiltroPrioridade}">
                                <ComboBox.ItemsSource>
                                    <x:Array Type="{x:Type sys:String}">
                                        <sys:String>Todos</sys:String>
                                        <sys:String>Baixa</sys:String>
                                        <sys:String>Média</sys:String>
                                        <sys:String>Alta</sys:String>
                                    </x:Array>
                                </ComboBox.ItemsSource>
                            </ComboBox>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Margin="0,0,0,5">
                            <TextBlock Text="Estado Ticket:" Width="80" VerticalAlignment="Center"/>
                            <ComboBox Width="120" SelectedItem="{Binding FiltroEstadoTicket}">
                                <ComboBox.ItemsSource>
                                    <x:Array Type="{x:Type sys:String}">
                                        <sys:String>Todos</sys:String>
                                        <sys:String>porAtender</sys:String>
                                        <sys:String>emAtendimento</sys:String>
                                        <sys:String>atendido</sys:String>
                                    </x:Array>
                                </ComboBox.ItemsSource>
                            </ComboBox>

                            <TextBlock Text="Estado Atendimento:" Width="130" Margin="20,0,0,0" VerticalAlignment="Center"/>
                            <ComboBox Width="120" SelectedItem="{Binding FiltroEstadoAtendimento}">
                                <ComboBox.ItemsSource>
                                    <x:Array Type="{x:Type sys:String}">
                                        <sys:String>Todos</sys:String>
                                        <sys:String>aberto</sys:String>
                                        <sys:String>naoResolvido</sys:String>
                                        <sys:String>resolvido</sys:String>
                                    </x:Array>
                                </ComboBox.ItemsSource>
                            </ComboBox>
                        </StackPanel>

                        <Button Content="Aplicar Filtros" Width="150" HorizontalAlignment="Left" Click="BtnAplicarFiltros_Click"/>
                    </StackPanel>
                </GroupBox>

            </StackPanel>

            <DataGrid ItemsSource="{Binding Tickets}" 
                      SelectedItem="{Binding TicketSelecionado, Mode=TwoWay}"
                      AutoGenerateColumns="False" Height="300">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="40"/>
                    <DataGridTextColumn Header="Tipo" Binding="{Binding Tipo}" Width="100"/>
                    <DataGridTextColumn Header="Subtipo" Binding="{Binding SubtipoProblema}" Width="100"/>
                    <DataGridTextColumn Header="Prioridade" Binding="{Binding Prioridade}" Width="100"/>
                    <DataGridTextColumn Header="Descrição" Binding="{Binding Descricao}" Width="200"/>
                    <DataGridTextColumn Header="Estado Ticket" Binding="{Binding EstadoTicket}" Width="100"/>
                    <DataGridTextColumn Header="Estado Atendimento" Binding="{Binding EstadoAtendimento}" Width="120"/>
                    <DataGridTextColumn Header="Data Criação" Binding="{Binding DataCriacao, StringFormat={}{0:dd/MM/yyyy HH:mm}}" Width="120"/>
                    <DataGridTextColumn Header="Data Atendimento" Binding="{Binding DataAtendimento, StringFormat={}{0:dd/MM/yyyy HH:mm}}" Width="130"/>
                    <DataGridTextColumn Header="Data Conclusão" Binding="{Binding DataConclusao, StringFormat={}{0:dd/MM/yyyy HH:mm}}" Width="130"/>
                    <DataGridTextColumn Header="Funcionário" Binding="{Binding NomeFuncionario}" Width="150"/>
                    <DataGridTextColumn Header="Detalhes Técnico" Binding="{Binding DetalhesTecnico}" Width="200"/>
                </DataGrid.Columns>


            </DataGrid>

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                <Button Content="Responder Ticket" Width="150" Command="{Binding ResponderCommand}" Margin="0,0,10,0"/>
                <Button Content="Voltar" Width="100" Click="BtnVoltar_Click"/>
            </StackPanel>
        </StackPanel>

        <!-- Mapas / Estatísticas -->
        <StackPanel x:Name="MapaSection" Visibility="Collapsed" Margin="10">
            <StackPanel Orientation="Horizontal" Margin="0,10">
                <TextBlock Text="Data Início:" VerticalAlignment="Center" Margin="0,0,5,0"/>
                <DatePicker SelectedDate="{Binding DataInicioFiltro}" Width="120" />
                <TextBlock Text="Data Fim:" VerticalAlignment="Center" Margin="10,0,5,0"/>
                <DatePicker SelectedDate="{Binding DataFimFiltro}" Width="120" />
            </StackPanel>

            <Button Content="Aplicar Filtros" Width="120" Click="BtnAplicarFiltros_Click1" />

            <TextBlock Text="Estatísticas dos Tickets respondidos" FontSize="18" FontWeight="Bold" Margin="0,0,0,10"/>

            <TextBlock Text="{Binding TotalTickets, StringFormat=Total de Tickets: {0}}" FontSize="14" Margin="0,0,0,5"/>
            <TextBlock Text="{Binding TicketsAtendidos, StringFormat=Tickets Atendidos: {0}}" FontSize="14" Margin="0,0,0,5"/>
            <TextBlock Text="{Binding TicketsResolvidos, StringFormat=Tickets Resolvidos: {0}}" FontSize="14" Margin="0,0,0,5"/>
            <TextBlock Text="{Binding TicketsNaoResolvidos, StringFormat=Tickets Não Resolvidos: {0}}" FontSize="14" Margin="0,0,0,5"/>

            <TextBlock Text="Percentagens:" FontWeight="Bold" Margin="10,15,0,5"/>
            <TextBlock Text="{Binding PercentualRespondidos, StringFormat=Tickets Respondidos / Total: {0}}" FontSize="14" Margin="0,0,0,2"/>
            <TextBlock Text="{Binding PercentualResolvidosVsAtendidos, StringFormat=Tickets Resolvidos / Atendidos: {0}}" FontSize="14" Margin="0,0,0,2"/>
            <TextBlock Text="{Binding PercentualResolvidosVsNaoResolvidos, StringFormat=Tickets Resolvidos / (Resolvidos + Não Resolvidos): {0}}" FontSize="14" Margin="0,0,0,10"/>

            <TextBlock Text="Média de Tempo de Atendimento por Tipo:" FontWeight="Bold" Margin="0,0,0,5"/>
            <ItemsControl ItemsSource="{Binding MediaTempoAtendimentoPorTipoLista}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <TextBlock FontSize="14" Margin="0,2,0,2">
        <Run Text="{Binding Tipo}" />
        <Run Text=": " />
        <Run Text="{Binding MediaTempoFormatada, Mode=OneWay}" />
                        </TextBlock>
                    </DataTemplate>

                </ItemsControl.ItemTemplate>
            </ItemsControl>

            <Button Content="Voltar" Width="100" HorizontalAlignment="Right" Margin="0,10,0,0" Click="BtnVoltar_Click"/>
        </StackPanel>


    </Grid>
</Window>

